<div class="catalog-header">
  <div class="tabs" role="tablist" aria-label="Каталог">
    <button
      type="button"
      class="tab"
      role="tab"
      (click)="activeTab='info'"
      [class.active]="activeTab==='info'"
      [attr.aria-selected]="activeTab === 'info'"
    >
      Основная информация
    </button>
    <button
      type="button"
      class="tab"
      role="tab"
      (click)="activeTab='logistics'"
      [class.active]="activeTab==='logistics'"
      [attr.aria-selected]="activeTab === 'logistics'"
    >
      Закупка и логистика
    </button>
  </div>
  <button type="button" class="catalog-header__action" (click)="openNewProductPopup()">
    + Новый товар
  </button>
</div>
<div class="error-message" *ngIf="loadErrorMessage() as errorMessage">{{ errorMessage }}</div>

<ng-container *ngIf="catalogData as catalogData">
  <ng-container *ngIf="catalogData.length; else emptyCatalog">

    <app-catalog-table
      *ngIf="activeTab==='info'"
      [viewMode]="'info'"
      [data]="sortedInfoItems()"
      [sortState]="getSortState('info')"
      (sort)="onSort('info', $event)"
      (sortByKey)="onSortKey('info', $event.column, $event.event)"
    ></app-catalog-table>

    <app-catalog-table
      *ngIf="activeTab==='logistics'"
      [viewMode]="'logistics'"
      [data]="sortedLogisticsItems()"
      [sortState]="getSortState('logistics')"
      (sort)="onSort('logistics', $event)"
      (sortByKey)="onSortKey('logistics', $event.column, $event.event)"
    ></app-catalog-table>

  </ng-container>
</ng-container>

<ng-template #emptyCatalog>
  <div class="catalog-empty">
    <app-empty
      class="mt-6 block"
      title="Каталог пока пуст"
      subtitle="Добавьте первый продукт, чтобы начать работу с каталогом."
    ></app-empty>
    <button type="button" class="catalog-empty__action" (click)="openNewProductPopup()">
      + Новый товар
    </button>
  </div>
</ng-template>

<app-catalog-new-product-popup
  *ngIf="isNewProductPopupVisible()"
  [errorMessage]="creationErrorMessage()"
  (cancel)="closeNewProductPopup()"
  (save)="addProduct($event)"
></app-catalog-new-product-popup>
